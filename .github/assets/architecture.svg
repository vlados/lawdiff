<svg width="1000" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: white; stroke: #1e40af; stroke-width: 2; }
      .api-box { fill: #60a5fa; stroke: #1e40af; stroke-width: 2; }
      .db-box { fill: #a78bfa; stroke: #7c3aed; stroke-width: 2; }
      .service-box { fill: #fbbf24; stroke: #f59e0b; stroke-width: 2; }
      .frontend-box { fill: #34d399; stroke: #059669; stroke-width: 2; }
      .text { font-family: system-ui, -apple-system, sans-serif; font-size: 16px; fill: #1e293b; }
      .text-white { font-family: system-ui, -apple-system, sans-serif; font-size: 16px; fill: white; font-weight: 600; }
      .title { font-family: system-ui, -apple-system, sans-serif; font-size: 20px; fill: #0f172a; font-weight: bold; }
      .subtitle { font-family: system-ui, -apple-system, sans-serif; font-size: 14px; fill: #475569; }
      .arrow { stroke: #475569; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#475569" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="500" y="40" class="title" text-anchor="middle">Архитектура на LawDiff</text>
  <text x="500" y="65" class="subtitle" text-anchor="middle">Path-based йерархична система за структуриране на законодателството</text>

  <!-- Layer 1: External API -->
  <rect x="350" y="100" width="300" height="80" rx="10" class="api-box"/>
  <text x="500" y="135" class="text-white" text-anchor="middle">APIS.BG API</text>
  <text x="500" y="160" class="subtitle" text-anchor="middle" fill="rgba(255,255,255,0.9)">Извличане на закони</text>

  <!-- Arrow 1 -->
  <path d="M 500 180 L 500 220" class="arrow"/>
  <text x="520" y="205" class="subtitle">JSON Response</text>

  <!-- Layer 2: Laravel Commands -->
  <rect x="200" y="220" width="600" height="120" rx="10" class="box"/>
  <text x="500" y="255" class="title" text-anchor="middle">Laravel Application</text>

  <!-- Commands -->
  <rect x="230" y="270" width="160" height="50" rx="5" fill="#e0e7ff" stroke="#6366f1" stroke-width="1"/>
  <text x="310" y="295" class="subtitle" text-anchor="middle" font-weight="600">laws:fetch</text>
  <text x="310" y="315" class="subtitle" text-anchor="middle">Metadata</text>

  <rect x="420" y="270" width="160" height="50" rx="5" fill="#e0e7ff" stroke="#6366f1" stroke-width="1"/>
  <text x="500" y="295" class="subtitle" text-anchor="middle" font-weight="600">laws:fetch-contents</text>
  <text x="500" y="315" class="subtitle" text-anchor="middle">Content + Process</text>

  <rect x="610" y="270" width="160" height="50" rx="5" fill="#e0e7ff" stroke="#6366f1" stroke-width="1"/>
  <text x="690" y="295" class="subtitle" text-anchor="middle" font-weight="600">laws:process-trees</text>
  <text x="690" y="315" class="subtitle" text-anchor="middle">Reprocess</text>

  <!-- Arrow 2 -->
  <path d="M 500 340 L 500 380" class="arrow"/>
  <text x="520" y="365" class="subtitle">Store</text>

  <!-- Layer 3: Database -->
  <rect x="300" y="380" width="400" height="120" rx="10" class="db-box"/>
  <text x="500" y="415" class="text-white" text-anchor="middle">PostgreSQL Database</text>

  <!-- Tables -->
  <rect x="330" y="435" width="150" height="45" rx="5" fill="rgba(255,255,255,0.9)" stroke="#7c3aed" stroke-width="1"/>
  <text x="405" y="455" class="subtitle" text-anchor="middle" font-weight="600">laws</text>
  <text x="405" y="472" class="subtitle" text-anchor="middle" font-size="12">Metadata</text>

  <rect x="520" y="435" width="150" height="45" rx="5" fill="rgba(255,255,255,0.9)" stroke="#7c3aed" stroke-width="1"/>
  <text x="595" y="455" class="subtitle" text-anchor="middle" font-weight="600">law_nodes</text>
  <text x="595" y="472" class="subtitle" text-anchor="middle" font-size="12">Structure + Paths</text>

  <!-- Arrow 3 -->
  <path d="M 500 500 L 500 540" class="arrow"/>
  <text x="520" y="525" class="subtitle">Process</text>

  <!-- Layer 4: Services -->
  <rect x="150" y="540" width="700" height="140" rx="10" class="service-box"/>
  <text x="500" y="575" class="text-white" text-anchor="middle">Processing Services</text>

  <!-- Service boxes -->
  <rect x="180" y="590" width="180" height="70" rx="5" fill="rgba(255,255,255,0.95)" stroke="#f59e0b" stroke-width="1"/>
  <text x="270" y="615" class="subtitle" text-anchor="middle" font-weight="600">LawTreeProcessor</text>
  <text x="270" y="635" class="subtitle" text-anchor="middle" font-size="12">HTML → Markdown</text>
  <text x="270" y="650" class="subtitle" text-anchor="middle" font-size="12">Parse Structure</text>

  <rect x="390" y="590" width="180" height="70" rx="5" fill="rgba(255,255,255,0.95)" stroke="#f59e0b" stroke-width="1"/>
  <text x="480" y="615" class="subtitle" text-anchor="middle" font-weight="600">LawPathBuilder</text>
  <text x="480" y="635" class="subtitle" text-anchor="middle" font-size="12">ЧЛ143/АЛ5А/Т3</text>
  <text x="480" y="650" class="subtitle" text-anchor="middle" font-size="12">Unique Paths</text>

  <rect x="600" y="590" width="220" height="70" rx="5" fill="rgba(255,255,255,0.95)" stroke="#f59e0b" stroke-width="1"/>
  <text x="710" y="615" class="subtitle" text-anchor="middle" font-weight="600">LawAmendmentParser</text>
  <text x="710" y="635" class="subtitle" text-anchor="middle" font-size="12">§ Paragraphs</text>
  <text x="710" y="650" class="subtitle" text-anchor="middle" font-size="12">Target Paths</text>

  <!-- Arrow 4 -->
  <path d="M 500 680 L 500 720" class="arrow"/>
  <text x="520" y="705" class="subtitle">Display</text>

  <!-- Layer 5: Frontend -->
  <rect x="250" y="720" width="500" height="60" rx="10" class="frontend-box"/>
  <text x="500" y="755" class="text-white" text-anchor="middle">API / Livewire Frontend</text>

  <!-- Path examples -->
  <g transform="translate(100, 100)">
    <rect x="750" y="200" width="220" height="180" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
    <text x="860" y="225" class="subtitle" text-anchor="middle" font-weight="bold">Path Examples</text>
    <text x="770" y="250" class="subtitle" font-size="13" font-family="monospace">ЧЛ143</text>
    <text x="770" y="270" class="subtitle" font-size="13" font-family="monospace">ЧЛ143/АЛ5</text>
    <text x="770" y="290" class="subtitle" font-size="13" font-family="monospace">ЧЛ143/АЛ5А</text>
    <text x="770" y="310" class="subtitle" font-size="13" font-family="monospace">ЧЛ143/АЛ5А/Т3</text>
    <text x="770" y="330" class="subtitle" font-size="13" font-family="monospace">ДОП/§6А</text>
    <text x="770" y="350" class="subtitle" font-size="13" font-family="monospace">ПЗР/§7</text>
  </g>
</svg>
